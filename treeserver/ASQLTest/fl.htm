<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">

<title>附录</title>
<meta name="Microsoft Border" content="t, default"></head>

<body bgcolor="#EAEAFB" link="#008080"><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>

<table border="0" width="85%" cellspacing="0" cellpadding="0" height="50">
  <tr>
    <td width="20%" height="50"><a href="http://tdb.com.cn"><img src="images/crsc.gif" alt="上海中铁高新软件中心" border="0" WIDTH="148" HEIGHT="42"></a></td>
    <td width="80%" height="50"><img src="_borders/asql.gif" alt="asql.gif (3772 bytes)" WIDTH="500" HEIGHT="40"></td>
  </tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" align="center"><a href="index.htm"><img src="images/intro.gif" alt="产品简介" border="0" WIDTH="93" HEIGHT="19"></a><img src="images/online.gif" alt="联机手册" border="0" WIDTH="93" HEIGHT="19"><img src="images/quote.gif" alt="产品报价" WIDTH="93" HEIGHT="19"><img src="images/back.gif" alt="意见反馈" border="0" WIDTH="93" HEIGHT="19"><img src="images/about.gif" alt="相关产品" WIDTH="93" HEIGHT="19"><a href="mailto:asql@tdb.com.cn"><img src="images/contact.gif" alt="请与我们联系" border="0" WIDTH="93" HEIGHT="19"></a></td>
  </tr>
</table>
</td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><!--msnavigation--><td valign="top">

<hr>
<div align="center"><center>

<table border="0" width="90%" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%"><h2 align="center"><font face="楷体_GB2312"><a NAME="_Toc437587467">附录</a></font></h2>
    <ol>
      <li><a NAME="_Toc437587468">ASQL表达式错误代码</a><b><br>
      </li>
      </b><table BORDER="1" CELLSPACING="1" BORDERCOLOR="#000000" CELLPADDING="7" WIDTH="555">
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="CENTER">错误编号</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="CENTER">错 误 说 明</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">0</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">1</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;变量引用错或使用不当&quot;, 
          </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">2</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;变量未定义&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">3</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;内存不够&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">4</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;必须指定数据库&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">5</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;找不到数据库&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">6</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;找不到域&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">7</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;表内无此库&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">8</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;动作参数错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">9</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;数据类型错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">10</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;嵌套太深&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">11</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;数组使用错&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">12</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;无此动作&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">13</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;函数调用错&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">14</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;内部错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">15</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;操作数类型错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">16</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;操作数太多&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">17</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;操作数太少&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">18</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;缺运算符&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">19</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;多运算符&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">20</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;函数引用失败,操作数不足或类型不对&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">21</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;操作符不符原型&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">22</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;表达式不全&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">23</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;运算符无效&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">24</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;少运算符&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">25</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;多余运算符&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">26</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;操作错&quot;, </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">27</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;数学运算错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">28</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;数组下标类型错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">29</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;文件只读&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">30</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;文件只写&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">31</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;类型不兼容&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">32</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;括号不匹配&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">33</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;表达式错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">34</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;引号错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">35</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;错误未定义&quot; </td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">36</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;引用函数时参数不足&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">37</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;Substr()函数起始位置错误&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">38</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;RelCnt()参数错&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">39</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;Record()引用，但没有目标定义&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">40</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;Statx()第2个参数应该是数组&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">41</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;Sumx()第2个参数应该是数组&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">42</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;Sigmay()参数错&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">43</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;Sigmax()参数错&quot;</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">44</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;文件创建失败&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">45</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;wsymbol()参数错&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">46</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;xMax()第2个参数应该是二维数组&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">47</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;xMin()第2个参数应该是二维数组&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">48</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;xAvg()第2,3个参数应该是二维数组，且相应维数定义相同&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">49</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;对目标表赋值，但目标表不存在，或对源进行域赋值，但书写形式不是\&quot;表名.域名\&quot;形式&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">50</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;代码库没有加载，hzth()&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">51</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;_ASQLUSER为系统只读变量&quot;,</td>
        </tr>
        <tr>
          <td WIDTH="13%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">52</td>
          <td WIDTH="87%" VALIGN="TOP" HEIGHT="1"><p ALIGN="JUSTIFY">&quot;写记录时数据检查出错&quot;</td>
        </tr>
      </table>
      <b>
      <li>　</li>
      <li><a NAME="_Toc437587469">ASQL语法错误代码</a></li>
      </b><p ALIGN="JUSTIFY">ASQL语法错是指在ASQL的描述语法中有不符合ASQL语法定义的成份，一般ASQL解释器在返回错误信息的同时还返回错误的位置。</p>
      <p ALIGN="JUSTIFY">char *AsqlErrorMes( void )</p>
      <p ALIGN="JUSTIFY">{</p>
      <p ALIGN="JUSTIFY">switch( qsError ) {</p>
      <p ALIGN="JUSTIFY">case 1001: return &quot;内存空间使用错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1002: return &quot;读语法文件时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1003: return &quot;查询对象识别时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1004: return &quot;动作(ACTION)处理时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1005: return &quot;预定义(PREDICATE)时内存申请错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1006: return &quot;动作处理时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1007: return &quot;表达式处理时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1008: return &quot;表达式执行时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 1009: return &quot;动作表达式(ACTION)书写错&quot;;</p>
      <p ALIGN="JUSTIFY">case 2001: return &quot;语法文件打不开&quot;;</p>
      <p ALIGN="JUSTIFY">case 2002: return &quot;语法文件读错&quot;;</p>
      <p ALIGN="JUSTIFY">case 2003: return &quot;查询对象(FROM)打开错&quot;;</p>
      <p ALIGN="JUSTIFY">case 2004: return &quot;查询对象(FROM)中(SCOPE:key,start,end)描述错&quot;;</p>
      <p ALIGN="JUSTIFY">case 2005: return &quot;SCOPE:描述中关键字错&quot;;</p>
      <p ALIGN="JUSTIFY">case 2006: return &quot;DATABASE:描述错&quot;;</p>
      <p ALIGN="JUSTIFY">case 2007: return &quot;no right of from tables&quot;;</p>
      <p ALIGN="JUSTIFY">case 2008: return &quot;FROM中别名命名错，应以字母开头&quot;;</p>
      <p ALIGN="JUSTIFY">case 3001: return &quot;注释太长&quot;;</p>
      <p ALIGN="JUSTIFY">case 3002: return &quot;字符串未结束&quot;;</p>
      <p ALIGN="JUSTIFY">case 3003: return &quot;表达式未结束&quot;;</p>
      <p ALIGN="JUSTIFY">case 3004: return &quot;无统计声明或其位置不对&quot;;</p>
      <p ALIGN="JUSTIFY">case 3005: return &quot;统计描述时表格项指示数字太大&quot;;</p>
      <p ALIGN="JUSTIFY">case 3006: return &quot;符号识别错&quot;;</p>
      <p ALIGN="JUSTIFY">case 3007: return &quot;动作识别错&quot;;</p>
      <p ALIGN="JUSTIFY">case 3014: return &quot;变量定义(PREDICATES)出错&quot;;</p>
      <p ALIGN="JUSTIFY">case 3016: return &quot;目标(TO)描述错&quot;;</p>
      <p ALIGN="JUSTIFY">case 3017: return &quot;不知名关键字或BEGIN END不匹配&quot;;</p>
      <p ALIGN="JUSTIFY">case 3018: return &quot;该出现关键字处无&quot;;</p>
      <p ALIGN="JUSTIFY">case 3019: return &quot;查询目标(TO)描述错&quot;;</p>
      <p ALIGN="JUSTIFY">case 3020: return &quot;预定义(PREDICATE)时不知明数据类型&quot;;</p>
      <p ALIGN="JUSTIFY">case 3021: return &quot;预定义(PREDICATE)时变量名太长&quot;;</p>
      <p ALIGN="JUSTIFY">case 3022: return &quot;条件(CONDITION)后无BEGIN&quot;;</p>
      <p ALIGN="JUSTIFY">case 3023: return &quot;条件(CONDITION)中出现不知名关键字&quot;;</p>
      <p ALIGN="JUSTIFY">case 3024: return &quot;条件(CONDITION)中BEGIN与END不对齐&quot;;</p>
      <p ALIGN="JUSTIFY">case 3025: return &quot;目标域名源库中不存在&quot;;</p>
      <p ALIGN="JUSTIFY">case 3026: return &quot;动作表达式出现不知名符号&quot;;</p>
      <p ALIGN="JUSTIFY">case 3027: return &quot;条件表达式中出现不知明变量或函数&quot;;</p>
      <p ALIGN="JUSTIFY">case 3028: return &quot;查询目标(TO)中域名错或无','号分隔&quot;;</p>
      <p ALIGN="JUSTIFY">case 4001: return &quot;表达式分析时内存错&quot;;</p>
      <p ALIGN="JUSTIFY">case 4002: return &quot;表达式书写错&quot;;</p>
      <p ALIGN="JUSTIFY">case 4003: return &quot;描述性动作分析错&quot;;</p>
      <p ALIGN="JUSTIFY">case 4004: return &quot;条件(CONDITION)一般性动作分析错&quot;;</p>
      <p ALIGN="JUSTIFY">case 4005: return &quot;统计中没有设定统计要求&quot;;</p>
      <p ALIGN="JUSTIFY">case 4006: return &quot;条件(CONDITION)只出现动作表达式而无条件表达式&quot;;</p>
      <p ALIGN="JUSTIFY">case 5001: return &quot;警告:目标文件不存在&quot;;</p>
      <p ALIGN="JUSTIFY">case 5002: return &quot;目标文件描述或创建错&quot;;</p>
      <p ALIGN="JUSTIFY">case 5003: return &quot;分组(Group By)语法错,分组关键字太长&quot;;</p>
      <p ALIGN="JUSTIFY">case 5004: return &quot;条件动作最后一遍执行错&quot;;</p>
      <p ALIGN="JUSTIFY">case 5005: return &quot;描述动作执行错&quot;;</p>
      <p ALIGN="JUSTIFY">case 5006: return &quot;条件动作第一遍执行错&quot;;</p>
      <p ALIGN="JUSTIFY">case 5007: return &quot;内部错，函数引用错&quot;;</p>
      <p ALIGN="JUSTIFY">case 5008: return &quot;分组索引无法建立&quot;;</p>
      <p ALIGN="JUSTIFY">case 5009: return &quot;dSetAwake()出错&quot;;</p>
      <p ALIGN="JUSTIFY">case 5010: return &quot;分组(Group By)索引引用错&quot;;</p>
      <p ALIGN="JUSTIFY">case 6001: return &quot;内部错&quot;;</p>
      <p ALIGN="JUSTIFY">case 6002: return &quot;FROM:关联关系描述错&quot;;</p>
      <p ALIGN="JUSTIFY">case 6004: return &quot;创建连接索引时错，可能是连接关键字描述错&quot;;</p>
      <p ALIGN="JUSTIFY">//case 6005: return &quot;从源中读取记录时错&quot;;</p>
      <p ALIGN="JUSTIFY">case 7001: return &quot;errorStamp&quot;;</p>
      <p ALIGN="JUSTIFY">case 7002: return &quot;取记录时出错&quot;;</p>
      <p ALIGN="JUSTIFY">case 7003: return &quot;ENDIF与IF不匹配&quot;;</p>
      <p ALIGN="JUSTIFY">case 7004: return &quot;ENDWHILE与WHILE不匹配&quot;;</p>
      <p ALIGN="JUSTIFY">case 7005: return &quot;LOOP与WHILE不匹配&quot;;</p>
      <p ALIGN="JUSTIFY">case 7006: return &quot;CALL函数但函数不存在&quot;;</p>
      <p ALIGN="JUSTIFY">case 7007: return &quot;execGramMan()出错&quot;;</p>
      <p ALIGN="JUSTIFY">case 7008: return &quot;ENDIF或ELSE或ENDWHILE前必须有Asql_LET&quot;;</p>
      <p ALIGN="JUSTIFY">case 7009: return &quot;ELSE与ENDIF不匹配&quot;;</p>
      <p ALIGN="JUSTIFY">case 9001: return &quot;目标表已经被独占打开&quot;;</p>
      <p ALIGN="JUSTIFY">}</p>
      <p ALIGN="JUSTIFY">return &quot;内部错&quot;;</p>
      <p ALIGN="JUSTIFY">} // end of function AsqlErrorMes()</p>
      <p ALIGN="JUSTIFY">　</p>
      <p ALIGN="JUSTIFY">　</p>
      <p ALIGN="JUSTIFY">　</p>
      <p ALIGN="JUSTIFY">　</p>
      <li><b><a NAME="_Toc437587470">可视化表格(ViTAB)简介</a></li>
      </b><p ALIGN="JUSTIFY">Vitab是用构件化的思想实现的，集文字编辑、Chart图、统计及查询表格等功能于一体的软件。在这个软件中，文字编辑、Chart图、表格等均以构件的形式出现，各种构件相互独立，统一管理，通过不同构件的组合、排放，拖移，可以灵活构造出任意复杂的表格。</p>
      <p ALIGN="JUSTIFY">2.功能：</p>
      <p ALIGN="JUSTIFY">Vitab功能主要表现为各构件的功能，现将各构件的功能描述如下：</p>
      <p ALIGN="JUSTIFY">(1) 编辑构件：</p>
      <p ALIGN="JUSTIFY">这种构件的主要功能是用来实现文字的输入，输入过程中，用户可以选择不同的字体，字型号，还可以进行一定的格式编排。</p>
      <p ALIGN="JUSTIFY">(2) Chart图构件：</p>
      <p ALIGN="JUSTIFY">这种构件的主要功能是可以将表格统计结果以直观的图表方式显示，且可以选择图形模式，如饼图，直方图，点线图等等。</p>
      <p ALIGN="JUSTIFY">(3) 统计表格构件：</p>
      <p ALIGN="JUSTIFY">统计表格构件主要用于累计，求和表格的构造。它用一种简单的方法构造出固定大小的二维表，通过构造数据源和条件，使表与数据库表建立联系，经过统计、运算后获得数据。</p>
      <p ALIGN="JUSTIFY">(4) 手工制表构件：</p>
      <p ALIGN="JUSTIFY">这种构件的主要功能是能够让用户通过手工的方式来绘出一张表格。绘这种表之前，用户只需知道表的大体形状，而且，在制表过程中可以随时调整。从而能够做到边构思边制表，提供了极大的灵活性。此外，可在所制表格中定义变量，轻松得到固定查询表。</p>
      <p ALIGN="JUSTIFY">3.使用：</p>
      <p ALIGN="JUSTIFY">Vitab 采用传统的Windows 
      界面风格，可以通过菜单和快捷按钮来选择相应的功能。</p>
      <p ALIGN="JUSTIFY">Vitab 中采用了本子、纸和构件三层的概念。Vitab 
      把用户在一次操作中构造的所有界面统称为一个本子，在一个本子中至少有一页纸，纸是用户进行版面设计的单位，用户一次对一张纸进行设计，可以在纸上放置不同的构件，可以任意调节它们的位置，大小，并输入相应的内容。例如：双击编辑构件，就会在屏幕上出现一个编辑框，让用户输入文本内容，并可在屏幕上通过工具栏选择字体、字号来优化显示。</p>
      <p ALIGN="JUSTIFY">当用户输入的内容在一个本子中放不下时，Vitab 
      就会自动生成另一个相同的本子来存放下一部分内容，其他本子和第一个本子中构件的存放位置完全相同，只是每个构件中存放的内容不一样。Vitab 
      处于设计状态时，屏幕上只能看第一个本子的内容，只有进行输出或打印预览时，用户才能其他本子的内容。</p>
      <p ALIGN="JUSTIFY">用户要增加新构件时，只需双击工具栏中代表该构件的图标，或当工具栏中代表该构件的图标处于按下状态时，或纸上画定一个区域，即可增加一个新的构件。当构件已在纸上存在时，单击它，即可选中该构件，然后就可对它进行拖动、缩放、移前、移后。</p>
      <p ALIGN="JUSTIFY">为了让用户能知道构件的具体位置，当处于设计状态时，程序为每个构件自动增加了一个边框，但输出时，这处边框是不存在的，为了使显示效果和输出效果相一致，用户可以选择不显示边框。</p>
      <b>
      <li>　</li>
      <li><a NAME="_Toc437587471">ASQL在医疗保险系统中应用的一个实例</a></li>
      </b><p ALIGN="JUSTIFY">医疗保险系统是一个涉及到电子货币支付、大量数据管理、有一定实时性要求的一个管理住处系统。在医疗保险系统中，ASQL得到了充分的应用，下面的这个例子就是决定充分引进ASQL的起因之一，透过这个例子，容易看到ASQL适合解决的事务。</p>
      <p ALIGN="JUSTIFY">医疗保险系统中有下面两个表（为了说明的方便，被简化了）：</p>
      <p ALIGN="JUSTIFY">(1) 收费信息表：DRUGBOOK，具体结构如下：</p>
      <p ALIGN="JUSTIFY">H_I 15（C） 医保号</p>
      <p ALIGN="JUSTIFY">S1 9.2（N） 本次费用</p>
      <p ALIGN="JUSTIFY">S2 9.2（N） 自付费用</p>
      <p ALIGN="JUSTIFY">S3 9.2（N） 医保报销费用</p>
      <p ALIGN="JUSTIFY">(2) 个人帐户表：SELFQ，具体结构如下：</p>
      <p ALIGN="JUSTIFY">H_I 15（C） 医保号</p>
      <p ALIGN="JUSTIFY">Q1 9.2（N） 付费段一</p>
      <p ALIGN="JUSTIFY">Q2 9.2（N） 付费段二</p>
      <p ALIGN="JUSTIFY">Q3 9.2（N） 付费段三</p>
      <p ALIGN="JUSTIFY">问题是这样的：</p>
      <p ALIGN="JUSTIFY">对DRUGBOOK中的每条收费记录到SELFQ中查其目前帐户消费情况，根据这个情况，决定本次费用S1如何分摊到S2和S3中，分摊完毕后，要将新的个个帐户信息写回到SELFQ中，因为这时个人已产生消费行为。</p>
      <p ALIGN="JUSTIFY">　</p>
      <b><p ALIGN="JUSTIFY">SQL解法：</p>
      </b><p ALIGN="JUSTIFY">/*对收费表DRUGBOOK的每条记录，将信息查询至MH_I,MS1,MS2,MS3中*/</p>
      <p ALIGN="JUSTIFY">SELECT H_I, Q1, Q2, Q3</p>
      <p ALIGN="JUSTIFY">FROM SELFQ</p>
      <p ALIGN="JUSTIFY">WHERE</p>
      <p ALIGN="JUSTIFY">H_I=当前DRUGBOOK中当前记录的H_I</p>
      <p ALIGN="JUSTIFY">/*根据付费算法，计算本次付费的S2,S3,Q1,Q2,Q3的新值</p>
      <p ALIGN="JUSTIFY">这里给出的算法不精确，只是表示一种算法 */</p>
      <p ALIGN="JUSTIFY">if (ms1&gt;s1)</p>
      <p ALIGN="JUSTIFY">{</p>
      <p ALIGN="JUSTIFY">ms1=ms1-s1;</p>
      <p ALIGN="JUSTIFY">} else {</p>
      <p ALIGN="JUSTIFY">s1=s1-ms1;</p>
      <p ALIGN="JUSTIFY">ms1=0;</p>
      <p ALIGN="JUSTIFY">……………</p>
      <p ALIGN="JUSTIFY">}</p>
      <p ALIGN="JUSTIFY">/*修改个人帐户SELFQ*/</p>
      <p ALIGN="JUSTIFY">UPDATE</p>
      <p ALIGN="JUSTIFY">SET Q1=MS1,Q2=MS2,Q3=MS3</p>
      <p ALIGN="JUSTIFY">FROM SELFQ</p>
      <p ALIGN="JUSTIFY">WHERE</p>
      <p ALIGN="JUSTIFY">H_I=当前DRUGBOOK中当前记录的H_I</p>
      <p ALIGN="JUSTIFY">/*修改收费信息DRUGBOOK*/</p>
      <p ALIGN="JUSTIFY">UPDATE</p>
      <p ALIGN="JUSTIFY">SET S1=………</p>
      <p ALIGN="JUSTIFY">FROM SELFQ</p>
      <p ALIGN="JUSTIFY">WHERE</p>
      <p ALIGN="JUSTIFY">H_I=当前DRUGBOOK中当前记录的H_I</p>
      <p ALIGN="JUSTIFY">　</p>
      <b><p ALIGN="JUSTIFY">ASQL解法：</p>
      </b><p ALIGN="JUSTIFY">UPDATE</p>
      <p ALIGN="JUSTIFY">FROM DRUGBOOK,SELFP,*H_I</p>
      <p ALIGN="JUSTIFY">CONDITION</p>
      <p ALIGN="JUSTIFY">BEGIN</p>
      <p ALIGN="JUSTIFY">1 /*对收费的每条记录*/</p>
      <p ALIGN="JUSTIFY">BEGIN</p>
      <p ALIGN="JUSTIFY">Q1:=Q1-S1</p>
      <p ALIGN="JUSTIFY">END</p>
      <p ALIGN="JUSTIFY">BEGIN</p>
      <p ALIGN="JUSTIFY">/*这个BEGIN相当于IF后的ELSE，这是负动作，条件表达式为假时才执行它。它还可以再嵌套下去*/</p>
      <p ALIGN="JUSTIFY">1 $ Q1:=Q1-M1</p>
      <p ALIGN="JUSTIFY">……………</p>
      <p ALIGN="JUSTIFY">END</p>
      <p ALIGN="JUSTIFY">1 $ CALREC(H_I)</p>
      <p ALIGN="JUSTIFY">END</p>
      <p ALIGN="JUSTIFY"><i>也可以这样</p>
      </i><p ALIGN="JUSTIFY">UPDATE</p>
      <p ALIGN="JUSTIFY">FROM DRUGBOOK,SELFP,*H_I</p>
      <p ALIGN="JUSTIFY">CONDITION</p>
      <p ALIGN="JUSTIFY">BEGIN</p>
      <p ALIGN="JUSTIFY">1 $ calyb(1,H_I,SELFQ.H_I);CALREC(2,H_I,SELFQ.H_I)</p>
      <p ALIGN="JUSTIFY">/*calyb()是用户自定义函数，它负责计算。</p>
      <p ALIGN="JUSTIFY">这里之所以传进去二个域名，是为了让这些域参数能将运算源表信息传给用户函数。*/</p>
      <p ALIGN="JUSTIFY">END</p>
      <p ALIGN="JUSTIFY">处理过程性很强的业务，不是SQL数据库的度项。本例中，假定DRUGBOOK有3000条记录，SELFQ有7万条记录，靠SQL处理每条记录需2秒（实际上在PC服务器上远不止2秒），共耗时：</p>
      <p ALIGN="JUSTIFY">2秒*3000=6000秒=100分钟</p>
      <p ALIGN="JUSTIFY">而靠ASQL解决需时不足5分钟。</p>
      <p ALIGN="JUSTIFY">　</p>
      <li><b><a NAME="_Toc437587472">举案说法</a></li>
      <p ALIGN="JUSTIFY">案1：记录可见性</p>
      </b><p ALIGN="JUSTIFY">插入到表中的记录并不是“立即可见的”，如在本次查询体的表打开期间，它就可能是不可见的。</p>
      <p ALIGN="JUSTIFY">FROM SUB0</p>
      <p ALIGN="JUSTIFY">TO CX.DBF,*</p>
      <p ALIGN="JUSTIFY">CONDITION</p>
      <p ALIGN="JUSTIFY">BEGIN</p>
      <p ALIGN="JUSTIFY">A1=1 $ insrec(1,CODE:=”12345”)</p>
      <p ALIGN="JUSTIFY">A1=2 $ askrec(@1)</p>
      <p ALIGN="JUSTIFY">END</p>
      <p ALIGN="JUSTIFY">上例中，新插入源表中的CODE=”12345”的记录就“可能”不被输入出到CX.DBF中去。</p>
      <b><p ALIGN="JUSTIFY">　</p>
      <p ALIGN="JUSTIFY">案2：数据字典引用</p>
      </b><p ALIGN="JUSTIFY">取数据字典中的信息</p>
      <p ALIGN="JUSTIFY">pred</p>
      <p ALIGN="JUSTIFY">string str[100]</p>
      <p ALIGN="JUSTIFY">let str:=sysvar(&quot;sub0@code:cfname&quot;)</p>
      <p ALIGN="JUSTIFY">let wsymbol(&quot;test&quot;)</p>
      <p ALIGN="JUSTIFY">　</p>
      <b><p ALIGN="JUSTIFY">案3：三元“？”表达式</p>
      </b><p ALIGN="JUSTIFY">pred</p>
      <p ALIGN="JUSTIFY">string str[20]</p>
      <p ALIGN="JUSTIFY">let 1=1 ? (2=2 ? str:=(&quot;1&quot;+&quot;2345&quot;)) : 
      str:=&quot;2&quot;+&quot;1&quot;</p>
      <p ALIGN="JUSTIFY">let 1=1 ? str:=&quot;test&quot;</p>
      <p ALIGN="JUSTIFY">let 1=2 ? str:=&quot;test&quot;</p>
      <p ALIGN="JUSTIFY">let 1=2 ? str:=&quot;test&quot; : (1=1 ? 
      str:=&quot;t1&quot;:str:=&quot;t2&quot;)</p>
      <p ALIGN="JUSTIFY">let 1=2 ? str:=&quot;test&quot; : (1=2 ? 
      str:=&quot;t1&quot;:str:=&quot;t2&quot;)</p>
      <p ALIGN="JUSTIFY">let wsymbol(&quot;test&quot;)</p>
      <p ALIGN="JUSTIFY">　</p>
      <li><b><a NAME="_Toc437587473">ASQL应用角本示例</a></b></li>
    </ol>
    <p>　</p>
    <p ALIGN="JUSTIFY">　</p>
    <p>　</p>
    <b><p ALIGN="JUSTIFY">示例1</b></p>
    <p ALIGN="JUSTIFY">FROM wuik.dbf</p>
    <p ALIGN="JUSTIFY">TO drugbook.dbf,\</p>
    <p ALIGN="JUSTIFY">MEDI_NO 10 c,INDATE 8 d ,BM 14 c,YL 18 4 n,CS 11 n,DJ 18 4 n ,\</p>
    <p ALIGN="JUSTIFY">ZJFY 18 4 n,GTFY 18 4 n,JZFY 18 4 n,YBFY 18 4 n, \</p>
    <p ALIGN="JUSTIFY">SUMFY 18 4 n,DEL_FLAG 4 c,HOSPITAL 10 c,\</p>
    <p ALIGN="JUSTIFY">t1 18 2 n,t2 18 2 n,t3 18 2 n,g1 18 2 n,g2 18 2 n,g3 18 2 n,no 10 c </p>
    <p ALIGN="JUSTIFY">condition</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p ALIGN="JUSTIFY">1 $ initrec(@1);askrec(@1,1);calrec(sumfy:=feeje,ybfy:=gtfy,\</p>
    <p ALIGN="JUSTIFY">jzfy:=zjfy,gtfy:=ybfy,t1:=jzfy1,t2:=jzfy2,t3:=jzfy3,zjfy:=zffy)</p>
    <p ALIGN="JUSTIFY">/* initrec(@1)清记录</p>
    <p ALIGN="JUSTIFY">askrec(@1,1)算同名域</p>
    <p ALIGN="JUSTIFY">calrec（）算其它域 */</p>
    <p ALIGN="JUSTIFY">end</p>
    <b><p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">示例2</p>
    </b><p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/* ph_i,pname,pcharge,pxb,pnl,psflb 都是string*/</p>
    <p ALIGN="JUSTIFY">pred</p>
    <p ALIGN="JUSTIFY">string ph_i[30]</p>
    <p ALIGN="JUSTIFY">string pname[30]</p>
    <p ALIGN="JUSTIFY">string pcharge[30]</p>
    <p ALIGN="JUSTIFY">string pxb[30]</p>
    <p ALIGN="JUSTIFY">string pnl[30]</p>
    <p ALIGN="JUSTIFY">string psflb[30]</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">from (scope: h_i, &quot;320000000000000&quot;, 
    &quot;320000000000000&quot;) people.dbf, sex.dbf, charge_t.dbf, 
    *h_i=e_expr,sex=e_expr,charge</p>
    <p ALIGN="JUSTIFY">cond</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p>h_i==&quot;320000000000000&quot; $ ph_i:=h_i; pname:=name; pcharge:=charge; 
    pxb:=sex.c_brif; pnl:=str(age(birthday)); psflb:=charge_t.c_brif</p>
    <p ALIGN="JUSTIFY">end</p>
    <p ALIGN="JUSTIFY">action wsymbol(&quot;test.dbf&quot;)</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <b><p ALIGN="JUSTIFY">示例3</b></p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">predicates </p>
    <p ALIGN="JUSTIFY">date d1</p>
    <p ALIGN="JUSTIFY">date d2</p>
    <p ALIGN="JUSTIFY">string str[1]</p>
    <p ALIGN="JUSTIFY">action d1 := dbfval(&quot;d:\\ls\\datedb&quot;, &quot;date1&quot;, 
    &quot;1&quot;)</p>
    <p ALIGN="JUSTIFY">action d2 := dbfval(&quot;d:\\ls\\datedb&quot;, &quot;date2&quot;, 
    &quot;1&quot;)</p>
    <p ALIGN="JUSTIFY">action str := dbfval(&quot;d:\\ls\\datedb&quot;, &quot;enjoy&quot;, 
    &quot;1&quot;)</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">from d:\ls\refre.dbf</p>
    <p ALIGN="JUSTIFY">condition</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p ALIGN="JUSTIFY">str = &quot;a&quot; $ askcnt(&quot;num&quot;);</p>
    <p ALIGN="JUSTIFY">end</p>
    <p ALIGN="JUSTIFY">action wsymbol(&quot;num.dbf&quot;)</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <b><p ALIGN="JUSTIFY">示例4</p>
    </b><p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*将数组传回客户端*/</p>
    <p ALIGN="JUSTIFY">pred</p>
    <p ALIGN="JUSTIFY">long x[10,10]</p>
    <p ALIGN="JUSTIFY">long y[10,10]</p>
    <p ALIGN="JUSTIFY">act webstream(x)</p>
    <p ALIGN="JUSTIFY">act webstream(y)</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*在客户端，须用一连续内存存放这些数组数据*/</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <p>　</p>
    <b><p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">示例5</b></p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*</p>
    <p ALIGN="JUSTIFY">* 统计一张表，横表头为可能出现的性别(sex)，坚表头为可能出现的单位(wu_name)</p>
    <p ALIGN="JUSTIFY">*/</p>
    <p ALIGN="JUSTIFY">pred</p>
    <p ALIGN="JUSTIFY">string strx[32000]</p>
    <p ALIGN="JUSTIFY">string stry[32000] /*为提高查找分组关键字速度而设的临时字符串*/</p>
    <p ALIGN="JUSTIFY">long xx[30,10] /*假定该表最多30行，10列*/</p>
    <p ALIGN="JUSTIFY">int i1,i2 /*分组关键字长度*/</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*X轴可出现情况分析*/</p>
    <p ALIGN="JUSTIFY">from lz0</p>
    <p ALIGN="JUSTIFY">/*横表头描述到一张表中*/</p>
    <p ALIGN="JUSTIFY">to xrd.dbf, L1 10 C</p>
    <p ALIGN="JUSTIFY">groupby sex</p>
    <p ALIGN="JUSTIFY">groupaction calrec(L1:=sex);strx:=strx+sex+&quot;,&quot;</p>
    <p ALIGN="JUSTIFY">cond</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p ALIGN="JUSTIFY">end</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*Y轴可出现情况分析*/</p>
    <p ALIGN="JUSTIFY">from lz0</p>
    <p ALIGN="JUSTIFY">groupby wu_name</p>
    <p ALIGN="JUSTIFY">groupaction calrec(L1:=wu_name);stry:=stry+wu_name+&quot;,&quot;</p>
    <p ALIGN="JUSTIFY">/*坚表头描述到一张表中*/</p>
    <p ALIGN="JUSTIFY">to yrd.dbf, L1 10 C</p>
    <p ALIGN="JUSTIFY">cond</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p ALIGN="JUSTIFY">end</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*X，Y轴单一关键字大小*/</p>
    <p ALIGN="JUSTIFY">act i1 := at(&quot;,&quot;,stry)</p>
    <p ALIGN="JUSTIFY">act i2 := at(&quot;,&quot;,strx)</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*进行实际统计*/</p>
    <p ALIGN="JUSTIFY">from lz0</p>
    <p ALIGN="JUSTIFY">cond</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p ALIGN="JUSTIFY">/*通知ASQL本次统计最多有30行*/</p>
    <p ALIGN="JUSTIFY">stat ,30</p>
    <p ALIGN="JUSTIFY">1 /*统计总约束条件，这里为永真*/</p>
    <p ALIGN="JUSTIFY">begin</p>
    <p ALIGN="JUSTIFY">1 $ staty( at(wu_name,stry)/i1 )</p>
    <p ALIGN="JUSTIFY">1 $ statx( at(sex,strx)/i2, xx )</p>
    <p ALIGN="JUSTIFY">end</p>
    <p ALIGN="JUSTIFY">end</p>
    <p ALIGN="JUSTIFY">　</p>
    <p ALIGN="JUSTIFY">/*将统计结果写出*/</p>
    <p ALIGN="JUSTIFY">act warray(&quot;test&quot;, xx)</td>
  </tr>
</table>
</center></div>

<p>　 
<!--msnavigation--></td></tr><!--msnavigation--></table></body>
</html>
